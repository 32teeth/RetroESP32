/*
  General
*/
#include <string.h>
#include <dirent.h>

#include "freertos/FreeRTOS.h"
#include "esp_wifi.h"
#include "esp_system.h"
#include "esp_event.h"
#include "esp_event_loop.h"
#include "nvs_flash.h"
#include "driver/gpio.h"
#include "esp_partition.h"
#include "esp_ota_ops.h"
#include "esp_heap_caps.h"

/*
  Odroid Components
*/
#include "../components/odroid/odroid_settings.h"
#include "../components/odroid/odroid_input.h"
#include "../components/odroid/odroid_display.h"
#include "../components/odroid/odroid_audio.h"
#include "../components/odroid/odroid_system.h"
#include "../components/odroid/odroid_sdcard.h"

/*
  Font
*/
#include "sprites/font.c"
#include "sprites/characters.c"

/*

*/
odroid_gamepad_state joystick;
odroid_battery_state battery_state;

/*
  Background
*/
#include "sprites/background.c"

/*

*/
#define WIDTH 320
#define HEIGHT 240
#define COLUMNS 20
#define ROWS 15
#define COUNT 11
#define ORIGIN 16
#define NEXT 208
#define GAP 48
int STEP = 0;
int BACKGROUND = 0;

/*

*/

/*
  Structs
*/
typedef struct{
  int x;
  int data[32][32];
} SYSTEM;
SYSTEM SYSTEMS[COUNT] = {
  {ORIGIN,{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,27903,27903,65535,27903,27903,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,65535,27903,27903,27903,27903,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,65535,65535,27903,27903,65535},{65535,27903,65535,27903,27903,27903,27903,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,27903,27903,65535,27903,65535,27903,27903,65535,27903,65535},{65535,27903,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,27903,27903,65535,65535,27903,27903,65535,27903,65535,27903,27903,65535,27903,65535,27903,27903,65535,27903,65535},{65535,27903,27903,27903,65535,27903,27903,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,65535,65535,27903,27903,65535},{65535,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT,{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP),{{27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*2),{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,65535,65535,27903,27903,27903,27903,65535,27903,27903,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{65535,65535,27903,65535,27903,27903,27903,65535,27903,27903,27903,65535,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535},{65535,65535,27903,65535,27903,27903,27903,27903,27903,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535},{65535,65535,27903,65535,27903,27903,65535,27903,65535,65535,65535,27903,65535,27903,27903,65535,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,65535,65535,27903,27903,65535,65535},{65535,65535,27903,65535,27903,27903,27903,27903,27903,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,27903,65535,65535},{65535,65535,27903,65535,27903,27903,27903,65535,27903,27903,27903,65535,27903,27903,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,27903,65535,65535},{65535,65535,27903,65535,65535,27903,27903,27903,27903,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,65535,65535,27903,27903,65535,65535},{65535,65535,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535},{65535,65535,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*3),{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903},{27903,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,27903},{27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,27903},{65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535},{65535,65535,65535,27903,27903,65535,65535,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,27903,27903,27903,65535,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,65535,65535,65535,65535,27903,27903,65535},{65535,65535,27903,27903,27903,27903,65535,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,65535,65535,65535,65535,27903,27903,65535},{65535,65535,65535,27903,27903,65535,65535,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,65535,27903,27903,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,27903,27903,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*4),{{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,65535,65535,65535,65535,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,65535,65535,65535,65535,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,65535,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,65535,65535,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*5),{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,65535,65535,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,65535,27903},{27903,65535,65535,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,27903,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903},{27903,65535,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,65535,65535,27903,27903,65535,27903},{27903,65535,65535,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,65535,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,65535,65535,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*6),{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,27903,65535,27903,65535,27903,65535,27903,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,27903,65535,65535,27903,27903,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,65535,27903,27903,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,27903,65535,27903,65535,27903,65535,27903,65535,27903,27903,65535,65535,27903,27903,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,27903,27903,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,27903,65535,65535,27903,27903,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*7),{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,27903,27903,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,27903,27903,65535,65535,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,27903,27903,27903,27903,65535,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,27903,27903,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903},{27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*8),{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,27903,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,27903,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,27903,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,27903,27903,65535,65535,65535,27903,27903,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535},{65535,65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535},{65535,65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535},{65535,65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535,27903,27903,27903,65535,65535,65535,65535,65535},{65535,65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}},
  {ORIGIN+NEXT+(GAP*9),{{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535},{65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535},{65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535},{65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535},{65535,65535,65535,27903,65535,65535,65535,65535,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535},{65535,65535,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,27903,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535},{65535,65535,65535,65535,27903,27903,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{65535,65535,65535,65535,27903,27903,27903,27903,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,65535,27903,65535,65535,65535,65535},{65535,65535,65535,65535,65535,27903,27903,65535,65535,27903,27903,27903,27903,65535,65535,27903,27903,65535,65535,27903,27903,65535,27903,27903,27903,65535,27903,27903,27903,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,65535,65535,27903,65535,65535,65535,27903,65535,65535,65535,65535},{65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535},{27903,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903},{27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903,27903}}}
};

typedef struct{
  int x;
  int y;
} OFFSET;
OFFSET POS = {64,64};


/*
  Clear Color
*/
#define CLEAR SYSTEMS[0].data[0][0]

/*
  Buffer
*/
unsigned short buffer[40000];

/*

*/
char EMULATORS[COUNT][30] = {
  "NINTENDO ENTERTAINMENT SYSTEM",
  "NINTENDO GAME BOY",
  "NINTENDO GAME BOY COLOR",
  "SEGA MASTER SYSTEM",
  "SEGA GAME GEAR",
  "COLECOVISION",
  "SINCLAIR ZX SPECTRUM 48K",
  "ATARI 2600",
  "ATARI 7800",
  "COMMODORE 64",
  "NEC TURBOGRAFX 16"
};

char DIRECTORIES[COUNT][10] = {
  "nes",
  "gb",
  "gbc",
  "sms",
  "gg",
  "col",
  "spectrum",
  "a26",
  "a78",
  "c64",
  "nec"
};

/*
  ====================
    Methods
  ====================
*/

/*
  debounce
*/
void debounce(int key)
{
  while (joystick.values[key]) odroid_input_gamepad_read(&joystick);
}

/*
  get letter
*/
int get_letter(char letter) {
  int dx = 0;
  char upper[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!-'&?.,/()[] ";
  char lower[] = "abcdefghijklmnopqrstuvwxyz0123456789!-'&?.,/()[] ";
  for(int n = 0; n < strlen(upper); n++) {
    if(letter == upper[n] || letter == lower[n]) {
      return letter != ' ' ? n * 5 : 0;
      break;
    }
  }
  return dx;
}

/*
  draw text
*/
void draw_text(short x, short y, char *string)
{
  int length = strlen(string);
  int size = 5;
  //y = 208;
  for(int n = 0; n < length; n++) {                                     
    int dx = get_letter(string[n]);
    for(int r = 0; r < (size); r++) {
      int i = 0;        
      if(string[n] != ' ') {
        for(int c = dx; c < (dx+size); c++) {
          if(characters[r][c] == 0) {
            buffer[0] = 65535;
            ili9341_write_frame_rectangleLE(x+i, y+r, 1, 1, buffer);
          }
          i++;
        }                                            
      }
    }
    x+= string[n] != ' ' ? 6 : 2;
  }
}

/*
  draw_mask
*/
void draw_mask(int x, int y, int w, int h) {
  for (int i = 0; i < w * h; i++) buffer[i] = CLEAR;
  ili9341_write_frame_rectangleLE(x, y, w, h, buffer);
}

/*
  draw_sky
*/
void draw_sky() {
  for (int i = 0; i < 320 * 48; i++) buffer[i] = CLEAR;
  ili9341_write_frame_rectangleLE(0, 0, 320, 48, buffer);
  ili9341_write_frame_rectangleLE(0, 48, 320, 48, buffer);
  ili9341_write_frame_rectangleLE(0, 96, 320, 48, buffer);
}

/*
  draw_systems
*/
void draw_systems() {
  draw_mask(0, POS.y, 320, 32);

  for(int e = 0; e < COUNT; e++) {
    int i = 0;                            
    int x = SYSTEMS[e].x;
    int y = POS.y;
    int w = 32;
    int h = 32;
    if(x > 0 && x < 288) {
      for(int r = 0; r < 32; r++) {
        for(int c = 0; c < 32; c++) {
          buffer[i] = SYSTEMS[e].data[r][c];                                       
          i++;
        }      
      }
      ili9341_write_frame_rectangleLE(x, y, w, h, buffer);
    }
  }
}

/*
  draw_background
*/
void draw_background() {
  int i = 0;  
  for(int r = 0; r < 96; r++) {
    for(int c = 0; c < 320; c++) {
      int offset = c;          
      if((offset+BACKGROUND) >= 640) {
        offset -= 640;
      }
      buffer[i] = background[r][offset+BACKGROUND];
      i++;
    }                                  
  }
  ili9341_write_frame_rectangleLE(0, 144, 320, 96, buffer);
}

/*
  draw_files
*/
void draw_files() {
  int x = POS.x;                     
  int y = POS.y;
  DIR *directory;   
  struct dirent *file;                  
  char path[256] = "/sd/roms";
  strcat(&path[strlen(path) - 1], DIRECTORIES[STEP]);

  if (!(directory = opendir(path))) {for (int i = 20; i < 30; i++) return (0);}
  //directory = opendir(path);
  draw_text(x,y,path);
  while ((file = readdir(directory)) != NULL) {
    //printf(file);
    //draw_text(x,y,file->d_name);
    //y+=16;
  };

  closedir(directory);
}


/*
  animate
*/
void animate(int dir) {
  draw_mask(0, 16, 320, 8);
  int bx[2][13] = {
    {10,8,8,6,6,6,4,4,4,2,2,2,2},
    {2,2,2,2,4,4,4,6,6,6,8,8,10}
  };
  int sx[4][13] = {
    {8,8,4,4,4,3,3,3,3,2,2,2,2}, // 48
    {30,26,20,20,18,18,16,16,12,12,8,8,4} // 208 30+26+20+20+18+18+16+16+12+12+8+8+4
  };  
  for(int i = 0; i < 13; i++) {    
    if(dir == -1) {
      // LEFT
      BACKGROUND -= bx[0][i];
      for(int e = 0; e < COUNT; e++) {
        SYSTEMS[e].x += STEP == (e-1) ? sx[1][i] : sx[0][i];
      }
    } else {
      // RIGHT
      BACKGROUND += bx[0][i];
      for(int e = 0; e < COUNT; e++) {
        SYSTEMS[e].x -= STEP == e ? sx[1][i] : sx[0][i];
      }      
    }
    draw_background();
    draw_systems();
  }  
  draw_text(16,16,EMULATORS[STEP]);  
  draw_files();
}

/*
  =========================
  MAIN
  =========================
*/
void app_main(void)
{
  nvs_flash_init();
  odroid_system_init();
  odroid_input_gamepad_init();

  switch (esp_sleep_get_wakeup_cause())
  {
    case ESP_SLEEP_WAKEUP_EXT0:
    {
      break;
    }

    case ESP_SLEEP_WAKEUP_EXT1:
    case ESP_SLEEP_WAKEUP_TIMER:
    case ESP_SLEEP_WAKEUP_TOUCHPAD:
    case ESP_SLEEP_WAKEUP_ULP:
    case ESP_SLEEP_WAKEUP_UNDEFINED:
    {
      break;
    }
    default:
      break;
  }

  // Display
  ili9341_prepare();
  ili9341_init();
  ili9341_clear(0);

  // SD Card
  odroid_sdcard_open("/sd");

  //
  draw_sky();
  draw_background(0);  
  draw_systems();
  draw_text(16,16,EMULATORS[0]); 
  draw_files();

  while (1) {
    odroid_input_gamepad_read(&joystick);
    // LEFT
    if(joystick.values[ODROID_INPUT_LEFT]) {
      STEP--;
      if( STEP < 0 ) { STEP = 0; } else { animate(-1); }
      debounce(ODROID_INPUT_LEFT);
    }
    // RIGHT
    if(joystick.values[ODROID_INPUT_RIGHT]) {
      STEP++;
      if( STEP > COUNT ) { STEP = COUNT; } else { animate(1); }     
      debounce(ODROID_INPUT_RIGHT);
    }    
  }
}